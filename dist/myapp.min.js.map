{"version":3,"sources":["node_modules/browser-pack/_prelude.js","source/app.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"myapp.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/// <reference path=\"../node_modules/phaser/typescript/phaser.d.ts\" />\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar GameATron = (function () {\n    function GameATron() {\n        this.game = new Phaser.Game(800, 600, Phaser.AUTO, // Default renderer\n        \"content\", // DOM element\n        this, false, // transparent\n        false); // anti-aliasing\n        this.extensions = new Array(new TestExtension(), new CursorExtension());\n        this.cursor = new Cursor();\n        this.room = new UfoRoom();\n        this.room.initialize(this.game, this.cursor);\n    }\n    GameATron.prototype.preload = function () {\n        this.room.preload();\n        this.cursor.preload(this.game);\n    };\n    GameATron.prototype.create = function () {\n        this.game.stage.smoothed = false;\n        // Center game canvas on page\n        // this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;\n        // this.game.scale.pageAlignHorizontally = true;\n        // this.game.scale.pageAlignVertically = true;\n        this.room.create();\n        this.cursor.create(this.game);\n    };\n    GameATron.prototype.update = function () {\n        this.room.update();\n    };\n    GameATron.prototype.render = function () {\n        //        this.game.debug.text(this.game.input.mouse.locked.toString(), 320, 32);\n    };\n    return GameATron;\n}());\nwindow.onload = function () {\n    var game = new GameATron();\n};\nvar Room = (function () {\n    function Room(name) {\n        this.name = name;\n    }\n    Room.prototype.initialize = function (game, cursor) {\n        this.game = game;\n        this.cursor = cursor;\n    };\n    Room.prototype.preload = function () {\n        this.game.load.image(this.name + \"-room-background\", \"assets/backgrounds/\" + this.name + \".png\");\n        // TODO Load other sprites.\n    };\n    Room.prototype.create = function () {\n        this.game.add.sprite(0, 0, this.name + \"-room-background\");\n        this.enter();\n    };\n    Room.prototype.update = function () {\n        if (this.cursor.overlap(this.hitbox)) {\n            if (this.hitbox !== this.selectedObject) {\n                console.log(\"enter\");\n                this.selectedObject = this.hitbox;\n            }\n        }\n        else if (this.selectedObject != null) {\n            console.log(\"exit\");\n            this.selectedObject = null;\n        }\n    };\n    Room.prototype.addObject = function () {\n        this.hitbox = this.game.add.sprite(500, 240, \"ufo-room-background\");\n        this.hitbox.scale.setTo(0.05, 0.25);\n        this.hitbox.inputEnabled = true;\n        this.hitbox.renderable = false;\n    };\n    return Room;\n}());\nvar UfoRoom = (function (_super) {\n    __extends(UfoRoom, _super);\n    function UfoRoom() {\n        return _super.call(this, \"ufo\") || this;\n    }\n    UfoRoom.prototype.enter = function () {\n        this.addObject();\n    };\n    return UfoRoom;\n}(Room));\nvar Extension = (function () {\n    function Extension() {\n    }\n    return Extension;\n}());\nvar TestExtension = (function (_super) {\n    __extends(TestExtension, _super);\n    function TestExtension() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TestExtension.prototype.preload = function (game) {\n        game.load.bitmapFont(\"onesize\", \"../fonts/font.png\", \"../fonts/font.fnt\");\n    };\n    TestExtension.prototype.create = function (game) {\n        //this.textbox = game.add.bitmapText(200, 560, \"onesize\", \"...\", 20);\n        this.hitbox = game.add.sprite(500, 240, \"ufo-room-background\");\n        this.hitbox.scale.setTo(0.05, 0.25);\n        this.hitbox.inputEnabled = true;\n        this.hitbox.renderable = false;\n        this.hitbox.events.onEnterBounds.add(function () {\n            //  this.textbox.text = \"Look at fridge\";\n            // this.textbox.updateText();\n        }, this);\n        // if (sprite1.overlap(sprite2)) {  // do something...}\n        // Print some test text.\n        var text = game.add.bitmapText(200, 560, \"onesize\", \"Talk to cleverly disguised Rolorob.\", 20);\n    };\n    TestExtension.prototype.render = function (game) {\n        //\n    };\n    return TestExtension;\n}(Extension));\nvar CursorExtension = (function (_super) {\n    __extends(CursorExtension, _super);\n    function CursorExtension() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    CursorExtension.prototype.preload = function (game) {\n        game.load.spritesheet(\"cursor\", \"assets/sprites/cursor58x58.png\", 58, 58);\n    };\n    CursorExtension.prototype.create = function (game) {\n        var _this = this;\n        // Create a sprite for the cursor.\n        this.cursor = game.add.sprite(game.world.centerX, game.world.centerY, \"cursor\");\n        console.log(this.cursor);\n        var cursorBlink = this.cursor.animations.add(\"blink\");\n        this.cursor.animations.play(\"blink\", 6, true);\n        // Lock the pointer on mousedown.\n        game.canvas.addEventListener(\"mousedown\", function () {\n            game.input.mouse.requestPointerLock();\n        });\n        // Register a move callback to render our own cursor.\n        game.input.addMoveCallback(function (pointer, x, y, click) {\n            // If the cursor is locked to the game, and the callback was not fired from a 'click' event\n            // (such as a mouse click or touch down) - as then it might contain incorrect movement values\n            if (game.input.mouse.locked && !click) {\n                _this.cursor.x += game.input.mouse.event.movementX;\n                _this.cursor.y += game.input.mouse.event.movementY;\n            }\n        }, this);\n    };\n    CursorExtension.prototype.render = function (game) {\n        game.debug.body(this.cursor);\n    };\n    return CursorExtension;\n}(Extension));\nvar Cursor = (function () {\n    function Cursor() {\n    }\n    Cursor.prototype.preload = function (game) {\n        game.load.spritesheet(\"cursor\", \"assets/sprites/cursor58x58.png\", 58, 58);\n    };\n    Cursor.prototype.create = function (game) {\n        var _this = this;\n        // Create a sprite for the cursor.\n        this.cursor = game.add.sprite(game.world.centerX, game.world.centerY, \"cursor\");\n        var cursorBlink = this.cursor.animations.add(\"blink\");\n        this.cursor.animations.play(\"blink\", 6, true);\n        // Lock the pointer on mousedown.\n        game.canvas.addEventListener(\"mousedown\", function () {\n            game.input.mouse.requestPointerLock();\n        });\n        // Register a move callback to render our own cursor.\n        game.input.addMoveCallback(function (pointer, x, y, click) {\n            // If the cursor is locked to the game, and the callback was not fired from a 'click' event\n            // (such as a mouse click or touch down) - as then it might contain incorrect movement values\n            if (game.input.mouse.locked && !click) {\n                _this.cursor.x += game.input.mouse.event.movementX;\n                _this.cursor.y += game.input.mouse.event.movementY;\n            }\n        }, this);\n    };\n    Cursor.prototype.overlap = function (sprite) {\n        return this.cursor.overlap(sprite);\n    };\n    return Cursor;\n}());\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzb3VyY2UvYXBwLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL25vZGVfbW9kdWxlcy9waGFzZXIvdHlwZXNjcmlwdC9waGFzZXIuZC50c1wiIC8+XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBHYW1lQVRyb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdhbWVBVHJvbigpIHtcbiAgICAgICAgdGhpcy5nYW1lID0gbmV3IFBoYXNlci5HYW1lKDgwMCwgNjAwLCBQaGFzZXIuQVVUTywgLy8gRGVmYXVsdCByZW5kZXJlclxuICAgICAgICBcImNvbnRlbnRcIiwgLy8gRE9NIGVsZW1lbnRcbiAgICAgICAgdGhpcywgZmFsc2UsIC8vIHRyYW5zcGFyZW50XG4gICAgICAgIGZhbHNlKTsgLy8gYW50aS1hbGlhc2luZ1xuICAgICAgICB0aGlzLmV4dGVuc2lvbnMgPSBuZXcgQXJyYXkobmV3IFRlc3RFeHRlbnNpb24oKSwgbmV3IEN1cnNvckV4dGVuc2lvbigpKTtcbiAgICAgICAgdGhpcy5jdXJzb3IgPSBuZXcgQ3Vyc29yKCk7XG4gICAgICAgIHRoaXMucm9vbSA9IG5ldyBVZm9Sb29tKCk7XG4gICAgICAgIHRoaXMucm9vbS5pbml0aWFsaXplKHRoaXMuZ2FtZSwgdGhpcy5jdXJzb3IpO1xuICAgIH1cbiAgICBHYW1lQVRyb24ucHJvdG90eXBlLnByZWxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucm9vbS5wcmVsb2FkKCk7XG4gICAgICAgIHRoaXMuY3Vyc29yLnByZWxvYWQodGhpcy5nYW1lKTtcbiAgICB9O1xuICAgIEdhbWVBVHJvbi5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmdhbWUuc3RhZ2Uuc21vb3RoZWQgPSBmYWxzZTtcbiAgICAgICAgLy8gQ2VudGVyIGdhbWUgY2FudmFzIG9uIHBhZ2VcbiAgICAgICAgLy8gdGhpcy5nYW1lLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG4gICAgICAgIC8vIHRoaXMuZ2FtZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xuICAgICAgICAvLyB0aGlzLmdhbWUuc2NhbGUucGFnZUFsaWduVmVydGljYWxseSA9IHRydWU7XG4gICAgICAgIHRoaXMucm9vbS5jcmVhdGUoKTtcbiAgICAgICAgdGhpcy5jdXJzb3IuY3JlYXRlKHRoaXMuZ2FtZSk7XG4gICAgfTtcbiAgICBHYW1lQVRyb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5yb29tLnVwZGF0ZSgpO1xuICAgIH07XG4gICAgR2FtZUFUcm9uLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vICAgICAgICB0aGlzLmdhbWUuZGVidWcudGV4dCh0aGlzLmdhbWUuaW5wdXQubW91c2UubG9ja2VkLnRvU3RyaW5nKCksIDMyMCwgMzIpO1xuICAgIH07XG4gICAgcmV0dXJuIEdhbWVBVHJvbjtcbn0oKSk7XG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBnYW1lID0gbmV3IEdhbWVBVHJvbigpO1xufTtcbnZhciBSb29tID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSb29tKG5hbWUpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB9XG4gICAgUm9vbS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChnYW1lLCBjdXJzb3IpIHtcbiAgICAgICAgdGhpcy5nYW1lID0gZ2FtZTtcbiAgICAgICAgdGhpcy5jdXJzb3IgPSBjdXJzb3I7XG4gICAgfTtcbiAgICBSb29tLnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmdhbWUubG9hZC5pbWFnZSh0aGlzLm5hbWUgKyBcIi1yb29tLWJhY2tncm91bmRcIiwgXCJhc3NldHMvYmFja2dyb3VuZHMvXCIgKyB0aGlzLm5hbWUgKyBcIi5wbmdcIik7XG4gICAgICAgIC8vIFRPRE8gTG9hZCBvdGhlciBzcHJpdGVzLlxuICAgIH07XG4gICAgUm9vbS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmdhbWUuYWRkLnNwcml0ZSgwLCAwLCB0aGlzLm5hbWUgKyBcIi1yb29tLWJhY2tncm91bmRcIik7XG4gICAgICAgIHRoaXMuZW50ZXIoKTtcbiAgICB9O1xuICAgIFJvb20ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuY3Vyc29yLm92ZXJsYXAodGhpcy5oaXRib3gpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5oaXRib3ggIT09IHRoaXMuc2VsZWN0ZWRPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVudGVyXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPYmplY3QgPSB0aGlzLmhpdGJveDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnNlbGVjdGVkT2JqZWN0ICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXhpdFwiKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPYmplY3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSb29tLnByb3RvdHlwZS5hZGRPYmplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaGl0Ym94ID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoNTAwLCAyNDAsIFwidWZvLXJvb20tYmFja2dyb3VuZFwiKTtcbiAgICAgICAgdGhpcy5oaXRib3guc2NhbGUuc2V0VG8oMC4wNSwgMC4yNSk7XG4gICAgICAgIHRoaXMuaGl0Ym94LmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuaGl0Ym94LnJlbmRlcmFibGUgPSBmYWxzZTtcbiAgICB9O1xuICAgIHJldHVybiBSb29tO1xufSgpKTtcbnZhciBVZm9Sb29tID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVWZvUm9vbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVZm9Sb29tKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgXCJ1Zm9cIikgfHwgdGhpcztcbiAgICB9XG4gICAgVWZvUm9vbS5wcm90b3R5cGUuZW50ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYWRkT2JqZWN0KCk7XG4gICAgfTtcbiAgICByZXR1cm4gVWZvUm9vbTtcbn0oUm9vbSkpO1xudmFyIEV4dGVuc2lvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRXh0ZW5zaW9uKCkge1xuICAgIH1cbiAgICByZXR1cm4gRXh0ZW5zaW9uO1xufSgpKTtcbnZhciBUZXN0RXh0ZW5zaW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGVzdEV4dGVuc2lvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUZXN0RXh0ZW5zaW9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRlc3RFeHRlbnNpb24ucHJvdG90eXBlLnByZWxvYWQgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICAgICAgICBnYW1lLmxvYWQuYml0bWFwRm9udChcIm9uZXNpemVcIiwgXCIuLi9mb250cy9mb250LnBuZ1wiLCBcIi4uL2ZvbnRzL2ZvbnQuZm50XCIpO1xuICAgIH07XG4gICAgVGVzdEV4dGVuc2lvbi5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKGdhbWUpIHtcbiAgICAgICAgLy90aGlzLnRleHRib3ggPSBnYW1lLmFkZC5iaXRtYXBUZXh0KDIwMCwgNTYwLCBcIm9uZXNpemVcIiwgXCIuLi5cIiwgMjApO1xuICAgICAgICB0aGlzLmhpdGJveCA9IGdhbWUuYWRkLnNwcml0ZSg1MDAsIDI0MCwgXCJ1Zm8tcm9vbS1iYWNrZ3JvdW5kXCIpO1xuICAgICAgICB0aGlzLmhpdGJveC5zY2FsZS5zZXRUbygwLjA1LCAwLjI1KTtcbiAgICAgICAgdGhpcy5oaXRib3guaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5oaXRib3gucmVuZGVyYWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmhpdGJveC5ldmVudHMub25FbnRlckJvdW5kcy5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gIHRoaXMudGV4dGJveC50ZXh0ID0gXCJMb29rIGF0IGZyaWRnZVwiO1xuICAgICAgICAgICAgLy8gdGhpcy50ZXh0Ym94LnVwZGF0ZVRleHQoKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIC8vIGlmIChzcHJpdGUxLm92ZXJsYXAoc3ByaXRlMikpIHsgIC8vIGRvIHNvbWV0aGluZy4uLn1cbiAgICAgICAgLy8gUHJpbnQgc29tZSB0ZXN0IHRleHQuXG4gICAgICAgIHZhciB0ZXh0ID0gZ2FtZS5hZGQuYml0bWFwVGV4dCgyMDAsIDU2MCwgXCJvbmVzaXplXCIsIFwiVGFsayB0byBjbGV2ZXJseSBkaXNndWlzZWQgUm9sb3JvYi5cIiwgMjApO1xuICAgIH07XG4gICAgVGVzdEV4dGVuc2lvbi5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKGdhbWUpIHtcbiAgICAgICAgLy9cbiAgICB9O1xuICAgIHJldHVybiBUZXN0RXh0ZW5zaW9uO1xufShFeHRlbnNpb24pKTtcbnZhciBDdXJzb3JFeHRlbnNpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDdXJzb3JFeHRlbnNpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ3Vyc29yRXh0ZW5zaW9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEN1cnNvckV4dGVuc2lvbi5wcm90b3R5cGUucHJlbG9hZCA9IGZ1bmN0aW9uIChnYW1lKSB7XG4gICAgICAgIGdhbWUubG9hZC5zcHJpdGVzaGVldChcImN1cnNvclwiLCBcImFzc2V0cy9zcHJpdGVzL2N1cnNvcjU4eDU4LnBuZ1wiLCA1OCwgNTgpO1xuICAgIH07XG4gICAgQ3Vyc29yRXh0ZW5zaW9uLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvLyBDcmVhdGUgYSBzcHJpdGUgZm9yIHRoZSBjdXJzb3IuXG4gICAgICAgIHRoaXMuY3Vyc29yID0gZ2FtZS5hZGQuc3ByaXRlKGdhbWUud29ybGQuY2VudGVyWCwgZ2FtZS53b3JsZC5jZW50ZXJZLCBcImN1cnNvclwiKTtcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5jdXJzb3IpO1xuICAgICAgICB2YXIgY3Vyc29yQmxpbmsgPSB0aGlzLmN1cnNvci5hbmltYXRpb25zLmFkZChcImJsaW5rXCIpO1xuICAgICAgICB0aGlzLmN1cnNvci5hbmltYXRpb25zLnBsYXkoXCJibGlua1wiLCA2LCB0cnVlKTtcbiAgICAgICAgLy8gTG9jayB0aGUgcG9pbnRlciBvbiBtb3VzZWRvd24uXG4gICAgICAgIGdhbWUuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZ2FtZS5pbnB1dC5tb3VzZS5yZXF1ZXN0UG9pbnRlckxvY2soKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJlZ2lzdGVyIGEgbW92ZSBjYWxsYmFjayB0byByZW5kZXIgb3VyIG93biBjdXJzb3IuXG4gICAgICAgIGdhbWUuaW5wdXQuYWRkTW92ZUNhbGxiYWNrKGZ1bmN0aW9uIChwb2ludGVyLCB4LCB5LCBjbGljaykge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnNvciBpcyBsb2NrZWQgdG8gdGhlIGdhbWUsIGFuZCB0aGUgY2FsbGJhY2sgd2FzIG5vdCBmaXJlZCBmcm9tIGEgJ2NsaWNrJyBldmVudFxuICAgICAgICAgICAgLy8gKHN1Y2ggYXMgYSBtb3VzZSBjbGljayBvciB0b3VjaCBkb3duKSAtIGFzIHRoZW4gaXQgbWlnaHQgY29udGFpbiBpbmNvcnJlY3QgbW92ZW1lbnQgdmFsdWVzXG4gICAgICAgICAgICBpZiAoZ2FtZS5pbnB1dC5tb3VzZS5sb2NrZWQgJiYgIWNsaWNrKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuY3Vyc29yLnggKz0gZ2FtZS5pbnB1dC5tb3VzZS5ldmVudC5tb3ZlbWVudFg7XG4gICAgICAgICAgICAgICAgX3RoaXMuY3Vyc29yLnkgKz0gZ2FtZS5pbnB1dC5tb3VzZS5ldmVudC5tb3ZlbWVudFk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH07XG4gICAgQ3Vyc29yRXh0ZW5zaW9uLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICAgICAgICBnYW1lLmRlYnVnLmJvZHkodGhpcy5jdXJzb3IpO1xuICAgIH07XG4gICAgcmV0dXJuIEN1cnNvckV4dGVuc2lvbjtcbn0oRXh0ZW5zaW9uKSk7XG52YXIgQ3Vyc29yID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDdXJzb3IoKSB7XG4gICAgfVxuICAgIEN1cnNvci5wcm90b3R5cGUucHJlbG9hZCA9IGZ1bmN0aW9uIChnYW1lKSB7XG4gICAgICAgIGdhbWUubG9hZC5zcHJpdGVzaGVldChcImN1cnNvclwiLCBcImFzc2V0cy9zcHJpdGVzL2N1cnNvcjU4eDU4LnBuZ1wiLCA1OCwgNTgpO1xuICAgIH07XG4gICAgQ3Vyc29yLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvLyBDcmVhdGUgYSBzcHJpdGUgZm9yIHRoZSBjdXJzb3IuXG4gICAgICAgIHRoaXMuY3Vyc29yID0gZ2FtZS5hZGQuc3ByaXRlKGdhbWUud29ybGQuY2VudGVyWCwgZ2FtZS53b3JsZC5jZW50ZXJZLCBcImN1cnNvclwiKTtcbiAgICAgICAgdmFyIGN1cnNvckJsaW5rID0gdGhpcy5jdXJzb3IuYW5pbWF0aW9ucy5hZGQoXCJibGlua1wiKTtcbiAgICAgICAgdGhpcy5jdXJzb3IuYW5pbWF0aW9ucy5wbGF5KFwiYmxpbmtcIiwgNiwgdHJ1ZSk7XG4gICAgICAgIC8vIExvY2sgdGhlIHBvaW50ZXIgb24gbW91c2Vkb3duLlxuICAgICAgICBnYW1lLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGdhbWUuaW5wdXQubW91c2UucmVxdWVzdFBvaW50ZXJMb2NrKCk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBSZWdpc3RlciBhIG1vdmUgY2FsbGJhY2sgdG8gcmVuZGVyIG91ciBvd24gY3Vyc29yLlxuICAgICAgICBnYW1lLmlucHV0LmFkZE1vdmVDYWxsYmFjayhmdW5jdGlvbiAocG9pbnRlciwgeCwgeSwgY2xpY2spIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSBjdXJzb3IgaXMgbG9ja2VkIHRvIHRoZSBnYW1lLCBhbmQgdGhlIGNhbGxiYWNrIHdhcyBub3QgZmlyZWQgZnJvbSBhICdjbGljaycgZXZlbnRcbiAgICAgICAgICAgIC8vIChzdWNoIGFzIGEgbW91c2UgY2xpY2sgb3IgdG91Y2ggZG93bikgLSBhcyB0aGVuIGl0IG1pZ2h0IGNvbnRhaW4gaW5jb3JyZWN0IG1vdmVtZW50IHZhbHVlc1xuICAgICAgICAgICAgaWYgKGdhbWUuaW5wdXQubW91c2UubG9ja2VkICYmICFjbGljaykge1xuICAgICAgICAgICAgICAgIF90aGlzLmN1cnNvci54ICs9IGdhbWUuaW5wdXQubW91c2UuZXZlbnQubW92ZW1lbnRYO1xuICAgICAgICAgICAgICAgIF90aGlzLmN1cnNvci55ICs9IGdhbWUuaW5wdXQubW91c2UuZXZlbnQubW92ZW1lbnRZO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKTtcbiAgICB9O1xuICAgIEN1cnNvci5wcm90b3R5cGUub3ZlcmxhcCA9IGZ1bmN0aW9uIChzcHJpdGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3Vyc29yLm92ZXJsYXAoc3ByaXRlKTtcbiAgICB9O1xuICAgIHJldHVybiBDdXJzb3I7XG59KCkpO1xuIl19"}